# Υπηρεσία Ενοικίασης Οχημάτων(microservices branch)
Σε αυτό το project γίνεται η αρχιτεκτονική μετάβαση αρχικού branch από μονόλιθο σε microservices  
Φοιτητές: Γεωργιάδης Ελευθέριος(f3312304), Γκίνης Εύαγγελος(f3312303)  
## ΚΑΤΑΝΟΜΗ ΤΗΣ ΛΕΙΤΟΥΡΓΙΚΟΤΗΤΑΣ (ΑΠΑΙΤΗΣΕΙΣ)
- Customer-microservice  
    1.	Κάθε πελάτης που θέλει να ενοικιάσει ένα όχημα θα πρέπει να κάνει αρχικά εγγραφή (όνομα, επώνυμο, email, password, τηλέφωνο, διεύθυνση, αριθμό πιστωτικής κάρτας).
  2.	Κάθε πελάτης μπορεί να ενημερώνει τα στοιχεία του λογαριασμού του.
  3.	Ο πελάτης ενοικιάζει αυτοκίνητα.
  4.	Ο πελάτης θα πληρώνει, και η ενοικίαση θα τερματίζει.
- Company-microservice  
    1. 	Η ενοικίαση οχημάτων θα γίνεται από τις αντίστοιχες εταιρείες
  2.	Εγγραφή της εταιρείας με χρήση της υπηρεσίας. Κατά την εγγραφή καταχωρείται η επωνυμία, ΑΦΜ, email, password, τηλέφωνο, διεύθυνση, IBAN.
  3.	Κάθε εταιρεία διαθέτει κάποια οχήματα. Κάθε εταιρεία καταχωρεί και επικαιροποιεί τα στοιχεία των οχημάτων που διαθέτει προς ενοικίαση. Μεταξύ των στοιχείων του οχήματος περιλαμβάνεται ο τύπος του, το μοντέλο, χρονολογία, κατασκευαστής, τρέχοντα χιλιόμετρα οχήματος, αριθμός κυκλοφορίας και πάγια χρέωση ανά ημέρα.
  4.	Κάθε εταιρεία ορίζει μία ή περισσότερες πολιτικές χρέωσης. Η πολιτική χρέωσης διαμορφώνεται με βάση τον τύπο του οχήματος, τα χιλιόμετρα που έχουν διανυθεί και τις συνολικές ημέρες ενοικίασης. Υπάρχει πάγια χρέωση για κάθε ενοικίαση. Θα υπάρχει κλιμακωτή χρέωση στα χιλιόμετρα. Πχ,τα πρώτα 100χμ χρεώνονται 10λεπτά ανά χιλιόμετρο, τα επόμενα 100 με 15λεπτά ανά χιλιόμετρο, και πάνω από 200 με 20λεπτά ανά χιλιόμετρο.
- Rent-microservice  
  1.	Κατά την επιστροφή του οχήματος εκτελείται τεχνικός έλεγχος για να διαπιστωθούν τυχόν ζημιές που έχουν προκληθεί στο όχημα κατά την ενοικίαση. Ο έλεγχος γίνεται από τους τεχνικούς της εκάστοτε εταιρείας ενοικίασης. Στο τέλος θα προκύπτει το κόστος ζημιάς.
  2.	Μόλις ο έλεγχος τελειώσει θα υπολογίζεται η τελική τιμή, η οποία είναι πάγιο κόστος + χιλιομετρική χρέωση + κόστος ζημιών.   
## ΠΕΡΙΓΡΑΦΗ ΤΟΥ ΑΡΙ  
Για τον customer:  
  1. GET /customer/{custId} (Επιστρέφει τον πελάτη με custΙd={custId}
2.	GET /customer (Επιστρέφει όλους τους πελάτες)
3.	PUT /customer (Δημιουργεί νέου customer)
4.	PUT /customer/{custId} (Επεξεργασία των στοιχείων του customer με Id={customerId})
5.	POST /customer/{custId}/rent (Υποβολή νέας ενοικίασης (Δημιουργία νέου πόρου Rent)
6.	POST /customer/{custId}/returnVehicle (Επιστροφή νοικιαζόμενου οχήματος)
7.	DELETE /customer (Διαγραφή όλων των πελατών)
8.	DELETE /customer/{custId} (Διαγραφή του πελάτη με Id={custId})

Για το company:  
  1.	GET /company (Επιστρέφει όλες τις εταιρείες)
2.	GET /company/{compId} (Επιστρέφει την εταιρεία με Id={compId}
3.	GET /company/{compId}/vehicles (Επιστρέφει όλα τα οχήματα της εταιρείας με Id={compId})
4.	GET /company/{compId}/policy (Επιστρέφει την πολιτική χρέωσης της εταιρείας με Id={compId})
5.	PUT /company (Δημιουργία νέας εταιρείας)
6.	PUT /company/{compId} (Επεξεργασία των στοιχείων της εταιρείας με Id={custId})
7.	POST /company/{compId}/addVehicle (Προσθήκη νέου αυτοκινήτου)
8.	DELETE /company (Διαγραφή όλων των εταιρειών)
9.	DELETE /company/{compId} (Διαγραφή της εταιρείας με Id={compId})

Για το rent:  
  1. GET /rent (Επιστρέφει όλες τις ενοικιάσεις)
2.	GET /rent/{rentId} (Επιστρέφει την ενοικίαση με Id={rentId}
3.	GET /rent/{rentId}/customer (Επιστρέφει τον customer της ενοικίασης με Id={rentId}
4.	GET /rent/{rentId}/vehicle (Επιστρέφει το όχημα για το rent με id=rentId)
5.	GET /rent/{rentId}/technicalCheck (Επιστρέφει τον τεχνικό έλεγχο για το rent με id=rentId)
6.	PUT /rent/{rentId} (Ενημέρωση των στοιχείων μιας ενοικίασης)
7.	DELETE /rent (Διαγραφή όλων των ενοικιάσεων)
8.	DELETE /rent/{rentId} (Διαγραφή της ενοικίασης με Id=rentId)

## Περιγραφή της αλληλεπίδρασης των microservices μέσω κλήσεων REST υπηρεσιών  
**Endpoint: /customer/{custId}/makeRent**
Η υπηρεσία Customer καλεί την υπηρεσία Rent για την έναρξη μίας ενοικίασης  

**Endpoint: /customer/{custId}/returnVehicle**
Η υπηρεσία Customer καλεί την υπηρεσία Rent για την ολοκλήρωση μίας ενοικίασης. Εσωτερικά, καλείται η “pay” η οποία επικοινωνεί με την υπηρεσία Company.  

**Endpoint: /rent/{rentId}/customer** 
Πλεόν, εφόσον κάθε microservice έχει την δική του βάση δεδομένων, δεν μπορεί να κάνει lookup και να αναζητήσει δεδομένα που δεν της ανήκουν. Άρα, η υπηρεσία Rent για να επιστρέψει έναν πελάτη (για κάποιο rentId) θα πρέπει να επικοινωνήσει με την υπηρεσία Customer.  

**Endpoint: /rent/{rentId}/vehicle**
Ομοίως, η υπηρεσία Rent θα πρέπει να καλέσει την Company για να βρει ένα Vehicle (όχημα) που ζητείται.

## SEQUENCE DIAGRAM
![alt text](image.png)
